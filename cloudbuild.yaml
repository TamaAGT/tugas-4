# Build the container image
- name: "gcr.io/cloud-builders/docker"
  args: ["build", "-t", "gcr.io/prak-tcc-d/backend:$COMMIT_SHA", "."]

# Push the container image to Container Registry
- name: "gcr.io/cloud-builders/docker"
  args: ["push", "gcr.io/prak-tcc-d/backend:$COMMIT_SHA"]

# Deploy the container image to Cloud Run
- name: "gcr.io/cloud-builders/gcloud"
  args:
  - "run"
  - "deploy"
  - "backend"
  - "--image"
  - "gcr.io/prak-tcc-d/backend:$COMMIT_SHA"
  - "--platform"
  - "managed"
  - "--region"
  - "us-central1"
  - "--allow-unauthenticated"
